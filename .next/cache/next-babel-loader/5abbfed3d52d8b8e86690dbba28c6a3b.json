{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime-corejs2/regenerator\";\nimport _objectSpread from \"@babel/runtime-corejs2/helpers/esm/objectSpread\";\nimport _asyncToGenerator from \"@babel/runtime-corejs2/helpers/esm/asyncToGenerator\";\nimport _classCallCheck from \"@babel/runtime-corejs2/helpers/esm/classCallCheck\";\nimport _createClass from \"@babel/runtime-corejs2/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"@babel/runtime-corejs2/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"@babel/runtime-corejs2/helpers/esm/getPrototypeOf\";\nimport _inherits from \"@babel/runtime-corejs2/helpers/esm/inherits\";\nvar __jsx = React.createElement;\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport Parse from 'parse';\nimport { Animated } from 'react-animated-css';\nimport { connect } from 'react-redux';\nimport cookie from 'js-cookie';\nimport Router from 'next/router';\nimport * as qs from 'qs';\nimport { i18n } from '../i18n';\nimport { setUser } from '../store';\n\nvar Signup =\n/*#__PURE__*/\nfunction (_React$Component) {\n  _inherits(Signup, _React$Component);\n\n  function Signup(props) {\n    var _this;\n\n    _classCallCheck(this, Signup);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(Signup).call(this, props));\n    _this.state = {\n      email: '',\n      error: '',\n      loading: false\n    };\n\n    if (process.browser) {\n      var _Router$query = Router.query,\n          email = _Router$query.email,\n          username = _Router$query.username,\n          ref = _Router$query.ref;\n\n      if (email || username) {\n        _this.state.email = decodeURIComponent(email || username);\n\n        _this.register(true);\n      } else if (ref) {\n        cookie.set('ref', ref);\n      }\n    }\n\n    return _this;\n  }\n\n  _createClass(Signup, [{\n    key: \"register\",\n    value: function () {\n      var _register = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee() {\n        var notMounted,\n            validateEmail,\n            email,\n            atSplit,\n            user,\n            country,\n            ref,\n            _user,\n            _args = arguments;\n\n        return _regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                notMounted = _args.length > 0 && _args[0] !== undefined ? _args[0] : false;\n\n                validateEmail = function validateEmail(email) {\n                  var re = /^(([^<>()[\\]\\\\.,;:\\s@\"]+(\\.[^<>()[\\]\\\\.,;:\\s@\"]+)*)|(\".+\"))@((\\[[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\])|(([a-zA-Z\\-0-9]+\\.)+[a-zA-Z]{2,}))$/;\n                  return re.test(String(email).toLowerCase());\n                };\n\n                email = this.state.email;\n\n                if (!(!email || !validateEmail(email))) {\n                  _context.next = 6;\n                  break;\n                }\n\n                if (notMounted) {\n                  this.state = _objectSpread({}, this.state, {\n                    error: 'invalid-email'\n                  });\n                } else {\n                  this.setState({\n                    error: 'invalid-email'\n                  });\n                }\n\n                return _context.abrupt(\"return\");\n\n              case 6:\n                if (notMounted) {\n                  this.state = _objectSpread({}, this.state, {\n                    loading: true,\n                    error: ''\n                  });\n                } else {\n                  this.setState({\n                    loading: true,\n                    error: ''\n                  });\n                }\n\n                email = email.toLowerCase().trim();\n                atSplit = email.split('@');\n\n                if (email.includes('gmail')) {\n                  email = \"\".concat(atSplit[0].split('+')[0].replace('.', ''), \"@\").concat(atSplit[1]);\n                }\n\n                _context.prev = 10;\n                _context.next = 13;\n                return Parse.User.logIn(email, email);\n\n              case 13:\n                user = _context.sent;\n                this.loggedIn(user);\n                _context.next = 37;\n                break;\n\n              case 17:\n                _context.prev = 17;\n                _context.t0 = _context[\"catch\"](10);\n                country = this.props.country;\n                ref = Router.query.ref;\n                _user = new Parse.User();\n\n                _user.set('username', email);\n\n                _user.set('password', email);\n\n                _user.set('email', email);\n\n                _user.set('country', country);\n\n                _user.set('lang', i18n.language);\n\n                _user.set('referred', ref || cookie.get('ref'));\n\n                _context.prev = 28;\n                _context.next = 31;\n                return _user.signUp();\n\n              case 31:\n                this.loggedIn(_user);\n                _context.next = 37;\n                break;\n\n              case 34:\n                _context.prev = 34;\n                _context.t1 = _context[\"catch\"](28);\n\n                if (notMounted) {\n                  this.state = _objectSpread({}, this.state, {\n                    error: _context.t1.message,\n                    loading: false\n                  });\n                } else {\n                  this.setState({\n                    error: _context.t1.message,\n                    loading: false\n                  });\n                }\n\n              case 37:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, this, [[10, 17], [28, 34]]);\n      }));\n\n      function register() {\n        return _register.apply(this, arguments);\n      }\n\n      return register;\n    }()\n  }, {\n    key: \"loggedIn\",\n    value: function loggedIn(user) {\n      var setUserHandler = this.props.setUserHandler;\n      var query = Router.query,\n          pathname = Router.pathname;\n      var userJson = user && user.toJSON();\n      setUserHandler(userJson);\n      cookie.set('user', userJson);\n      query.ref = userJson.ref;\n      Router.push(pathname, \"\".concat(pathname, \"?\").concat(qs.stringify(query)));\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this2 = this;\n\n      var t = this.props.t;\n      var _this$state = this.state,\n          email = _this$state.email,\n          loading = _this$state.loading,\n          error = _this$state.error;\n      return __jsx(\"section\", {\n        className: \"fdb-block\",\n        \"data-block-type\": \"contents\",\n        \"data-id\": \"3\"\n      }, __jsx(\"div\", {\n        className: \"container\"\n      }, __jsx(\"div\", {\n        className: \"row align-items-center\"\n      }, __jsx(\"div\", {\n        className: \"col-10 col-sm-6 col-md-5 col-lg-4 m-auto pb-5 pb-md-0\",\n        style: {\n          zIndex: 10000\n        }\n      }, __jsx(\"p\", null, __jsx(\"img\", {\n        alt: \"App\",\n        className: \"img-fluid rounded-0 fr-fic fr-dii\",\n        src: \"https://cdn.jsdelivr.net/gh/froala/design-blocks@2.0.1/dist/imgs//draws/iphone-hand.svg\"\n      }))), __jsx(\"div\", {\n        className: \"col-12 ml-md-auto col-md-7 col-lg-6 pb-5 pb-md-0\",\n        style: {\n          zIndex: 10000\n        }\n      }, __jsx(\"p\", null, __jsx(\"img\", {\n        alt: \"Gift\",\n        className: \"fdb-icon fr-fic fr-dii\",\n        src: \"https://cdn.jsdelivr.net/gh/froala/design-blocks@2.0.1/dist/imgs//icons/gift.svg\"\n      })), __jsx(\"h1\", null, t('header')), __jsx(\"p\", {\n        className: \"lead\"\n      }, t('description')), __jsx(\"form\", {\n        className: \"input-group signup_form\",\n        noValidate: true,\n        onSubmit: function onSubmit(e) {\n          e.preventDefault();\n\n          _this2.register();\n        }\n      }, __jsx(\"input\", {\n        type: \"email\",\n        className: \"form-control \".concat(error ? 'is-invalid' : '', \" signup_form-email spacing\"),\n        placeholder: t('enter_email'),\n        value: email,\n        onChange: function onChange(event) {\n          _this2.setState({\n            email: event.target.value,\n            error: ''\n          });\n        }\n      }), __jsx(\"div\", {\n        className: \"input-group-append\"\n      }, __jsx(\"input\", {\n        className: \"btn btn-primary spacing\",\n        type: \"submit\",\n        value: t('Submit'),\n        disabled: loading\n      }))), __jsx(Animated, {\n        animationIn: \"fadeIn\",\n        animationInDuration: 3000,\n        animationOutDuration: 3000,\n        animationOut: \"fadeOut\",\n        isVisible: error !== ''\n      }, __jsx(\"p\", {\n        className: \"text-danger\",\n        style: {\n          marginTop: 10\n        }\n      }, error))))));\n    }\n  }]);\n\n  return Signup;\n}(React.Component);\n\nSignup.propTypes = {\n  t: PropTypes.func.isRequired,\n  setUserHandler: PropTypes.func.isRequired,\n  country: PropTypes.string.isRequired\n};\n\nvar mapStateToProps = function mapStateToProps(state) {\n  return {\n    country: state.country\n  };\n};\n\nvar mapDispatchToProps = {\n  setUserHandler: setUser\n};\nexport default connect(mapStateToProps, mapDispatchToProps)(Signup);","map":{"version":3,"sources":["C:\\Users\\Mahmoud\\merquant_prelunch\\components\\signup.jsx"],"names":["React","PropTypes","Parse","Animated","connect","cookie","Router","qs","i18n","setUser","Signup","props","state","email","error","loading","process","browser","query","username","ref","decodeURIComponent","register","set","notMounted","validateEmail","re","test","String","toLowerCase","setState","trim","atSplit","split","includes","replace","User","logIn","user","loggedIn","country","language","get","signUp","message","setUserHandler","pathname","userJson","toJSON","push","stringify","t","zIndex","e","preventDefault","event","target","value","marginTop","Component","propTypes","func","isRequired","string","mapStateToProps","mapDispatchToProps"],"mappings":";;;;;;;;;AAAA,OAAOA,KAAP,MAAkB,OAAlB;AACA,OAAOC,SAAP,MAAsB,YAAtB;AACA,OAAOC,KAAP,MAAkB,OAAlB;AACA,SAASC,QAAT,QAAyB,oBAAzB;AACA,SAASC,OAAT,QAAwB,aAAxB;AACA,OAAOC,MAAP,MAAmB,WAAnB;AACA,OAAOC,MAAP,MAAmB,aAAnB;AACA,OAAO,KAAKC,EAAZ,MAAoB,IAApB;AACA,SAASC,IAAT,QAAqB,SAArB;AACA,SAASC,OAAT,QAAwB,UAAxB;;IAEMC,M;;;;;AACJ,kBAAYC,KAAZ,EAAmB;AAAA;;AAAA;;AACjB,gFAAMA,KAAN;AACA,UAAKC,KAAL,GAAa;AACXC,MAAAA,KAAK,EAAE,EADI;AAEXC,MAAAA,KAAK,EAAE,EAFI;AAGXC,MAAAA,OAAO,EAAE;AAHE,KAAb;;AAKA,QAAIC,OAAO,CAACC,OAAZ,EAAqB;AAAA,0BACyBX,MADzB,CACXY,KADW;AAAA,UACFL,KADE,iBACFA,KADE;AAAA,UACKM,QADL,iBACKA,QADL;AAAA,UACeC,GADf,iBACeA,GADf;;AAEnB,UAAIP,KAAK,IAAIM,QAAb,EAAuB;AACrB,cAAKP,KAAL,CAAWC,KAAX,GAAmBQ,kBAAkB,CAACR,KAAK,IAAIM,QAAV,CAArC;;AACA,cAAKG,QAAL,CAAc,IAAd;AACD,OAHD,MAGO,IAAIF,GAAJ,EAAS;AACdf,QAAAA,MAAM,CAACkB,GAAP,CAAW,KAAX,EAAkBH,GAAlB;AACD;AACF;;AAfgB;AAgBlB;;;;;;;;;;;;;;;;;;;;;;AAEcI,gBAAAA,U,2DAAa,K;;AACpBC,gBAAAA,a,GAAgB,SAAhBA,aAAgB,CAACZ,KAAD,EAAW;AAC/B,sBAAMa,EAAE,GAAG,uJAAX;AACA,yBAAOA,EAAE,CAACC,IAAH,CAAQC,MAAM,CAACf,KAAD,CAAN,CACZgB,WADY,EAAR,CAAP;AAED,iB;;AAEKhB,gBAAAA,K,GAAU,KAAKD,K,CAAfC,K;;sBACF,CAACA,KAAD,IAAU,CAACY,aAAa,CAACZ,KAAD,C;;;;;AAC1B,oBAAIW,UAAJ,EAAgB;AACd,uBAAKZ,KAAL,qBAAkB,KAAKA,KAAvB;AAA8BE,oBAAAA,KAAK,EAAE;AAArC;AACD,iBAFD,MAEO;AACL,uBAAKgB,QAAL,CAAc;AAAEhB,oBAAAA,KAAK,EAAE;AAAT,mBAAd;AACD;;;;;AAGH,oBAAIU,UAAJ,EAAgB;AACd,uBAAKZ,KAAL,qBACK,KAAKA,KADV;AAEEG,oBAAAA,OAAO,EAAE,IAFX;AAGED,oBAAAA,KAAK,EAAE;AAHT;AAKD,iBAND,MAMO;AACL,uBAAKgB,QAAL,CAAc;AACZf,oBAAAA,OAAO,EAAE,IADG;AAEZD,oBAAAA,KAAK,EAAE;AAFK,mBAAd;AAID;;AAEDD,gBAAAA,KAAK,GAAGA,KAAK,CAACgB,WAAN,GACLE,IADK,EAAR;AAEMC,gBAAAA,O,GAAUnB,KAAK,CAACoB,KAAN,CAAY,GAAZ,C;;AAChB,oBAAIpB,KAAK,CAACqB,QAAN,CAAe,OAAf,CAAJ,EAA6B;AAC3BrB,kBAAAA,KAAK,aAAMmB,OAAO,CAAC,CAAD,CAAP,CAAWC,KAAX,CAAiB,GAAjB,EAAsB,CAAtB,EAAyBE,OAAzB,CAAiC,GAAjC,EAAsC,EAAtC,CAAN,cAAmDH,OAAO,CAAC,CAAD,CAA1D,CAAL;AACD;;;;uBAEoB9B,KAAK,CAACkC,IAAN,CAAWC,KAAX,CAAiBxB,KAAjB,EAAwBA,KAAxB,C;;;AAAbyB,gBAAAA,I;AACN,qBAAKC,QAAL,CAAcD,IAAd;;;;;;;AAEQE,gBAAAA,O,GAAY,KAAK7B,K,CAAjB6B,O;AACSpB,gBAAAA,G,GAAUd,M,CAAnBY,K,CAASE,G;AAEXkB,gBAAAA,K,GAAO,IAAIpC,KAAK,CAACkC,IAAV,E;;AACbE,gBAAAA,KAAI,CAACf,GAAL,CAAS,UAAT,EAAqBV,KAArB;;AACAyB,gBAAAA,KAAI,CAACf,GAAL,CAAS,UAAT,EAAqBV,KAArB;;AACAyB,gBAAAA,KAAI,CAACf,GAAL,CAAS,OAAT,EAAkBV,KAAlB;;AACAyB,gBAAAA,KAAI,CAACf,GAAL,CAAS,SAAT,EAAoBiB,OAApB;;AACAF,gBAAAA,KAAI,CAACf,GAAL,CAAS,MAAT,EAAiBf,IAAI,CAACiC,QAAtB;;AACAH,gBAAAA,KAAI,CAACf,GAAL,CAAS,UAAT,EAAqBH,GAAG,IAAIf,MAAM,CAACqC,GAAP,CAAW,KAAX,CAA5B;;;;uBAGQJ,KAAI,CAACK,MAAL,E;;;AACN,qBAAKJ,QAAL,CAAcD,KAAd;;;;;;;;AAEA,oBAAId,UAAJ,EAAgB;AACd,uBAAKZ,KAAL,qBACK,KAAKA,KADV;AACiBE,oBAAAA,KAAK,EAAE,YAAM8B,OAD9B;AACuC7B,oBAAAA,OAAO,EAAE;AADhD;AAID,iBALD,MAKO;AACL,uBAAKe,QAAL,CAAc;AACZhB,oBAAAA,KAAK,EAAE,YAAM8B,OADD;AACU7B,oBAAAA,OAAO,EAAE;AADnB,mBAAd;AAID;;;;;;;;;;;;;;;;;;6BAKEuB,I,EAAM;AAAA,UACLO,cADK,GACc,KAAKlC,KADnB,CACLkC,cADK;AAAA,UAEL3B,KAFK,GAEeZ,MAFf,CAELY,KAFK;AAAA,UAEE4B,QAFF,GAEexC,MAFf,CAEEwC,QAFF;AAGb,UAAMC,QAAQ,GAAGT,IAAI,IAAIA,IAAI,CAACU,MAAL,EAAzB;AACAH,MAAAA,cAAc,CAACE,QAAD,CAAd;AACA1C,MAAAA,MAAM,CAACkB,GAAP,CAAW,MAAX,EAAmBwB,QAAnB;AAEA7B,MAAAA,KAAK,CAACE,GAAN,GAAY2B,QAAQ,CAAC3B,GAArB;AAEAd,MAAAA,MAAM,CAAC2C,IAAP,CAAYH,QAAZ,YAAyBA,QAAzB,cAAqCvC,EAAE,CAAC2C,SAAH,CAAahC,KAAb,CAArC;AACD;;;6BAEQ;AAAA;;AAAA,UACCiC,CADD,GACO,KAAKxC,KADZ,CACCwC,CADD;AAAA,wBAE2B,KAAKvC,KAFhC;AAAA,UAECC,KAFD,eAECA,KAFD;AAAA,UAEQE,OAFR,eAEQA,OAFR;AAAA,UAEiBD,KAFjB,eAEiBA,KAFjB;AAIP,aACE;AAAS,QAAA,SAAS,EAAC,WAAnB;AAA+B,2BAAgB,UAA/C;AAA0D,mBAAQ;AAAlE,SACE;AAAK,QAAA,SAAS,EAAC;AAAf,SACE;AAAK,QAAA,SAAS,EAAC;AAAf,SACE;AACE,QAAA,SAAS,EAAC,uDADZ;AAEE,QAAA,KAAK,EAAE;AAAEsC,UAAAA,MAAM,EAAE;AAAV;AAFT,SAIE,iBACE;AACE,QAAA,GAAG,EAAC,KADN;AAEE,QAAA,SAAS,EAAC,mCAFZ;AAGE,QAAA,GAAG,EAAC;AAHN,QADF,CAJF,CADF,EAcE;AACE,QAAA,SAAS,EAAC,kDADZ;AAEE,QAAA,KAAK,EAAE;AAAEA,UAAAA,MAAM,EAAE;AAAV;AAFT,SAIE,iBACE;AACE,QAAA,GAAG,EAAC,MADN;AAEE,QAAA,SAAS,EAAC,wBAFZ;AAGE,QAAA,GAAG,EAAC;AAHN,QADF,CAJF,EAWE,kBAAKD,CAAC,CAAC,QAAD,CAAN,CAXF,EAYE;AAAG,QAAA,SAAS,EAAC;AAAb,SACGA,CAAC,CAAC,aAAD,CADJ,CAZF,EAeE;AACE,QAAA,SAAS,EAAC,yBADZ;AAEE,QAAA,UAAU,MAFZ;AAGE,QAAA,QAAQ,EAAE,kBAACE,CAAD,EAAO;AACfA,UAAAA,CAAC,CAACC,cAAF;;AACA,UAAA,MAAI,CAAChC,QAAL;AACD;AANH,SAQE;AACE,QAAA,IAAI,EAAC,OADP;AAEE,QAAA,SAAS,yBAAkBR,KAAK,GAAG,YAAH,GAAkB,EAAzC,+BAFX;AAGE,QAAA,WAAW,EAAEqC,CAAC,CAAC,aAAD,CAHhB;AAIE,QAAA,KAAK,EAAEtC,KAJT;AAKE,QAAA,QAAQ,EAAE,kBAAC0C,KAAD,EAAW;AACnB,UAAA,MAAI,CAACzB,QAAL,CAAc;AACZjB,YAAAA,KAAK,EAAE0C,KAAK,CAACC,MAAN,CAAaC,KADR;AAEZ3C,YAAAA,KAAK,EAAE;AAFK,WAAd;AAID;AAVH,QARF,EAoBE;AAAK,QAAA,SAAS,EAAC;AAAf,SACE;AACE,QAAA,SAAS,EAAC,yBADZ;AAEE,QAAA,IAAI,EAAC,QAFP;AAGE,QAAA,KAAK,EAAEqC,CAAC,CAAC,QAAD,CAHV;AAIE,QAAA,QAAQ,EAAEpC;AAJZ,QADF,CApBF,CAfF,EA6CE,MAAC,QAAD;AACE,QAAA,WAAW,EAAC,QADd;AAEE,QAAA,mBAAmB,EAAE,IAFvB;AAGE,QAAA,oBAAoB,EAAE,IAHxB;AAIE,QAAA,YAAY,EAAC,SAJf;AAKE,QAAA,SAAS,EAAED,KAAK,KAAK;AALvB,SAOE;AAAG,QAAA,SAAS,EAAC,aAAb;AAA2B,QAAA,KAAK,EAAE;AAAE4C,UAAAA,SAAS,EAAE;AAAb;AAAlC,SAAsD5C,KAAtD,CAPF,CA7CF,CAdF,CADF,CADF,CADF;AA6ED;;;;EArLkBd,KAAK,CAAC2D,S;;AAwL3BjD,MAAM,CAACkD,SAAP,GAAmB;AACjBT,EAAAA,CAAC,EAAElD,SAAS,CAAC4D,IAAV,CAAeC,UADD;AAEjBjB,EAAAA,cAAc,EAAE5C,SAAS,CAAC4D,IAAV,CAAeC,UAFd;AAGjBtB,EAAAA,OAAO,EAAEvC,SAAS,CAAC8D,MAAV,CAAiBD;AAHT,CAAnB;;AAMA,IAAME,eAAe,GAAG,SAAlBA,eAAkB,CAACpD,KAAD;AAAA,SAAY;AAClC4B,IAAAA,OAAO,EAAE5B,KAAK,CAAC4B;AADmB,GAAZ;AAAA,CAAxB;;AAIA,IAAMyB,kBAAkB,GAAG;AACzBpB,EAAAA,cAAc,EAAEpC;AADS,CAA3B;AAIA,eAAeL,OAAO,CAAC4D,eAAD,EAAkBC,kBAAlB,CAAP,CAA6CvD,MAA7C,CAAf","sourcesContent":["import React from 'react';\r\nimport PropTypes from 'prop-types';\r\nimport Parse from 'parse';\r\nimport { Animated } from 'react-animated-css';\r\nimport { connect } from 'react-redux';\r\nimport cookie from 'js-cookie';\r\nimport Router from 'next/router';\r\nimport * as qs from 'qs';\r\nimport { i18n } from '../i18n';\r\nimport { setUser } from '../store';\r\n\r\nclass Signup extends React.Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n      email: '',\r\n      error: '',\r\n      loading: false,\r\n    };\r\n    if (process.browser) {\r\n      const { query: { email, username, ref } } = Router;\r\n      if (email || username) {\r\n        this.state.email = decodeURIComponent(email || username);\r\n        this.register(true);\r\n      } else if (ref) {\r\n        cookie.set('ref', ref);\r\n      }\r\n    }\r\n  }\r\n\r\n  async register(notMounted = false) {\r\n    const validateEmail = (email) => {\r\n      const re = /^(([^<>()[\\]\\\\.,;:\\s@\"]+(\\.[^<>()[\\]\\\\.,;:\\s@\"]+)*)|(\".+\"))@((\\[[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\])|(([a-zA-Z\\-0-9]+\\.)+[a-zA-Z]{2,}))$/;\r\n      return re.test(String(email)\r\n        .toLowerCase());\r\n    };\r\n\r\n    let { email } = this.state;\r\n    if (!email || !validateEmail(email)) {\r\n      if (notMounted) {\r\n        this.state = { ...this.state, error: 'invalid-email' };\r\n      } else {\r\n        this.setState({ error: 'invalid-email' });\r\n      }\r\n      return;\r\n    }\r\n    if (notMounted) {\r\n      this.state = {\r\n        ...this.state,\r\n        loading: true,\r\n        error: '',\r\n      };\r\n    } else {\r\n      this.setState({\r\n        loading: true,\r\n        error: '',\r\n      });\r\n    }\r\n\r\n    email = email.toLowerCase()\r\n      .trim();\r\n    const atSplit = email.split('@');\r\n    if (email.includes('gmail')) {\r\n      email = `${atSplit[0].split('+')[0].replace('.', '')}@${atSplit[1]}`;\r\n    }\r\n    try {\r\n      const user = await Parse.User.logIn(email, email);\r\n      this.loggedIn(user);\r\n    } catch (e) {\r\n      const { country } = this.props;\r\n      const { query: { ref } } = Router;\r\n\r\n      const user = new Parse.User();\r\n      user.set('username', email);\r\n      user.set('password', email);\r\n      user.set('email', email);\r\n      user.set('country', country);\r\n      user.set('lang', i18n.language);\r\n      user.set('referred', ref || cookie.get('ref'));\r\n\r\n      try {\r\n        await user.signUp();\r\n        this.loggedIn(user);\r\n      } catch (error) {\r\n        if (notMounted) {\r\n          this.state = {\r\n            ...this.state, error: error.message, loading: false,\r\n\r\n          };\r\n        } else {\r\n          this.setState({\r\n            error: error.message, loading: false,\r\n\r\n          });\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  loggedIn(user) {\r\n    const { setUserHandler } = this.props;\r\n    const { query, pathname } = Router;\r\n    const userJson = user && user.toJSON();\r\n    setUserHandler(userJson);\r\n    cookie.set('user', userJson);\r\n\r\n    query.ref = userJson.ref;\r\n\r\n    Router.push(pathname, `${pathname}?${qs.stringify(query)}`);\r\n  }\r\n\r\n  render() {\r\n    const { t } = this.props;\r\n    const { email, loading, error } = this.state;\r\n\r\n    return (\r\n      <section className=\"fdb-block\" data-block-type=\"contents\" data-id=\"3\">\r\n        <div className=\"container\">\r\n          <div className=\"row align-items-center\">\r\n            <div\r\n              className=\"col-10 col-sm-6 col-md-5 col-lg-4 m-auto pb-5 pb-md-0\"\r\n              style={{ zIndex: 10000 }}\r\n            >\r\n              <p>\r\n                <img\r\n                  alt=\"App\"\r\n                  className=\"img-fluid rounded-0 fr-fic fr-dii\"\r\n                  src=\"https://cdn.jsdelivr.net/gh/froala/design-blocks@2.0.1/dist/imgs//draws/iphone-hand.svg\"\r\n                />\r\n              </p>\r\n            </div>\r\n\r\n            <div\r\n              className=\"col-12 ml-md-auto col-md-7 col-lg-6 pb-5 pb-md-0\"\r\n              style={{ zIndex: 10000 }}\r\n            >\r\n              <p>\r\n                <img\r\n                  alt=\"Gift\"\r\n                  className=\"fdb-icon fr-fic fr-dii\"\r\n                  src=\"https://cdn.jsdelivr.net/gh/froala/design-blocks@2.0.1/dist/imgs//icons/gift.svg\"\r\n                />\r\n              </p>\r\n              <h1>{t('header')}</h1>\r\n              <p className=\"lead\">\r\n                {t('description')}\r\n              </p>\r\n              <form\r\n                className=\"input-group signup_form\"\r\n                noValidate\r\n                onSubmit={(e) => {\r\n                  e.preventDefault();\r\n                  this.register();\r\n                }}\r\n              >\r\n                <input\r\n                  type=\"email\"\r\n                  className={`form-control ${error ? 'is-invalid' : ''} signup_form-email spacing`}\r\n                  placeholder={t('enter_email')}\r\n                  value={email}\r\n                  onChange={(event) => {\r\n                    this.setState({\r\n                      email: event.target.value,\r\n                      error: '',\r\n                    });\r\n                  }}\r\n                />\r\n                <div className=\"input-group-append\">\r\n                  <input\r\n                    className=\"btn btn-primary spacing\"\r\n                    type=\"submit\"\r\n                    value={t('Submit')}\r\n                    disabled={loading}\r\n                  />\r\n                </div>\r\n              </form>\r\n\r\n              <Animated\r\n                animationIn=\"fadeIn\"\r\n                animationInDuration={3000}\r\n                animationOutDuration={3000}\r\n                animationOut=\"fadeOut\"\r\n                isVisible={error !== ''}\r\n              >\r\n                <p className=\"text-danger\" style={{ marginTop: 10 }}>{error}</p>\r\n              </Animated>\r\n\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </section>\r\n    );\r\n  }\r\n}\r\n\r\nSignup.propTypes = {\r\n  t: PropTypes.func.isRequired,\r\n  setUserHandler: PropTypes.func.isRequired,\r\n  country: PropTypes.string.isRequired,\r\n};\r\n\r\nconst mapStateToProps = (state) => ({\r\n  country: state.country,\r\n});\r\n\r\nconst mapDispatchToProps = {\r\n  setUserHandler: setUser,\r\n};\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(Signup);\r\n"]},"metadata":{},"sourceType":"module"}